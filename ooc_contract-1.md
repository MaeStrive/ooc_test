# 1.玩家状态合约

## 概述

该合约 `User` 管理游戏中的玩家数据，允许玩家升级、购买道具、切换钓鱼点等操作。它基于 `OpenZeppelin` 的 `AccessControl` 和 `Ownable` 合约，确保安全和权限控制。合约还集成了外部的 GMC 合约 (`IGMC`)，用于与游戏代币进行交互。

------

## 合约接口

#### `IGMC`

这是一个外部合约接口，用于与 GMC 代币进行交互。主要包含以下方法：

- `mint(address to, uint256 amount)`: 向指定地址铸造一定数量的 GMC。
- `balanceOf(address account)`: 获取指定地址的 GMC 余额。
- `transfer(address sender, address recipient, uint256 amount)`: 从指定发送者地址向接收者地址转移 GMC。

## 数据结构

#### `PlayerInfo`

该结构体存储玩家的基本信息：

- `fishingCount`: 当前钓鱼次数。
- `experience`: 玩家当前经验值。
- `level`: 玩家等级。
- `currentFishermanNFT`: 当前使用的渔夫 NFT ID。
- `currentRodNFT`: 当前使用的钓竿 NFT ID。
- `unlockedFishingSpots`: 一个布尔数组，表示玩家解锁的钓鱼点。
- `currentFishingSpot`: 当前选择的钓鱼点 ID。
- `fishPoolLevel`: 鱼池等级。
- `fishCount`: 各个星级鱼的数量。
- `interestRate`: 当前利率，可能用于计算某种奖励。
- `collectedGMC`: 玩家已收集的 GMC 代币数。
- `baitCount`: 玩家当前拥有的鱼饵数量。

## 状态变量

- `gmcContract`: 与 GMC 合约的实例。
- `_pendingOwner`: 即将成为新所有者的地址。
- `ADMIN_ROLE`: 管理员权限标识符，使用 `keccak256` 生成。
- `levelUpLimit`: 等级上限，默认值为 100。
- `experienceConfig`: 每一级所需的经验值数组。
- `baitPurchaseLimit`: 鱼饵购买上限，默认值为 99。
- `fishingCountLimit`: 钓鱼次数上限，默认值为 10。
- `baitPrice`: 鱼饵价格。

## 事件

- `PlayerAdded(address indexed playerAddress)`: 新玩家注册事件。
- `FishingCountDecreased(address indexed playerAddress, uint256 count)`: 钓鱼次数减少事件。
- `FishingCountRecovered(address indexed playerAddress, uint256 count)`: 钓鱼次数恢复事件。
- `PlayerLeveledUp(address indexed playerAddress, uint256 newLevel)`: 玩家升级事件。
- `ExperienceAdded(address indexed playerAddress, uint256 addedExp, uint256 newExp)`: 玩家经验增加事件。
- `FishermanChanged(address indexed playerAddress, uint256 newFishermanId)`: 玩家更换渔夫 NFT 事件。
- `RodChanged(address indexed playerAddress, uint256 newRodId)`: 玩家更换钓竿 NFT 事件。
- `FishingSpotSwitched(address indexed playerAddress, uint256 newSpotId)`: 玩家切换钓鱼点事件。
- `FishingSpotUnlocked(address indexed playerAddress, uint256 spotId)`: 玩家解锁新钓鱼点事件。
- `PlayerLevelUpdated(address indexed playerAddress, uint256 newLevel)`: 玩家等级更新事件。
- `FishPoolLevelUpdated(address indexed playerAddress, uint256 newLevel)`: 鱼池等级更新事件。
- `FishCountUpdated(address indexed playerAddress, uint256 star, uint256 newCount)`: 鱼的数量更新事件。
- `CollectedGMCUpdated(address indexed playerAddress, uint256 newAmount)`: 玩家已收集 GMC 数量更新事件。
- `BaitCountUpdated(address indexed playerAddress, uint256 newCount)`: 玩家鱼饵数量更新事件。
- `OwnershipTransferStarted(address indexed previousOwner, address indexed newOwner)`: 开始所有权转移事件。
- `ClaimGMC(address userAddress, uint256 count)`: 玩家领取 GMC 事件。

------

## 函数

### 0. 构造函数

#### 概要

| 函数中文名 | 构造函数    |
| ---------- | ----------- |
| 函数英文名 | constructor |
| 操作权限   | 无          |

#### 输入参数

| 参数名称    | 参数英文名   | 参数描述      | 参数类型 |
| ----------- | ------------ | ------------- | -------- |
| GMC合约地址 | _gmcContract | GMC合约的地址 | address  |
| 鱼饵价格    | _baitPrice   | 鱼饵的价格    | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

构造函数用于初始化合约状态。它设置默认等级上限为100，鱼饵购买上限为99，钓鱼次数上限为10，并将传入的鱼饵价格存储在状态变量中。通过 `_setupRole` 方法将合约创建者赋予默认管理员和管理员角色，同时初始化GMC合约的地址。

### 1. 添加管理员

#### 概要

| 函数中文名 | 添加管理员 |
| ---------- | ---------- |
| 函数英文名 | addAdmin   |
| 操作权限   | 拥有者     |

#### 输入参数

| 参数名称     | 参数英文名 | 参数描述       | 参数类型 |
| ------------ | ---------- | -------------- | -------- |
| 新管理员地址 | newAdmin   | 新管理员的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 2. 移除管理员

#### 概要

| 函数中文名 | 移除管理员  |
| ---------- | ----------- |
| 函数英文名 | removeAdmin |
| 操作权限   | 拥有者      |

#### 输入参数

| 参数名称   | 参数英文名 | 参数描述       | 参数类型 |
| ---------- | ---------- | -------------- | -------- |
| 管理员地址 | admin      | 要移除的管理员 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 3. 设置钓鱼次数上限函数

#### 概要

| 函数中文名 | 设置钓鱼次数上限函数 |
| ---------- | -------------------- |
| 函数英文名 | setFishingCountLimit |
| 操作权限   | 管理员               |

#### 输入参数

| 参数名称     | 参数英文名        | 参数描述               | 参数类型 |
| ------------ | ----------------- | ---------------------- | -------- |
| 钓鱼次数上限 | fishingCountLimit | 每个玩家的钓鱼次数上限 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 4. 添加用户

#### 概要

| 函数中文名 | 添加用户 |
| ---------- | -------- |
| 函数英文名 | addUser  |
| 操作权限   | 管理员   |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述         | 参数类型 |
| -------- | ----------- | ---------------- | -------- |
| 用户地址 | userAddress | 要注册的用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 5. 获取用户

#### 概要

| 函数中文名 | 获取用户 |
| ---------- | -------- |
| 函数英文名 | getUser  |
| 操作权限   | 管理员   |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述         | 参数类型 |
| -------- | ----------- | ---------------- | -------- |
| 用户地址 | userAddress | 要获取的用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述   |
| ---------- | ------------ |
| PlayerInfo | 玩家状态信息 |

------

### 6. 减少钓鱼次数

#### 概要

| 函数中文名 | 减少钓鱼次数         |
| ---------- | -------------------- |
| 函数英文名 | decreaseFishingCount |
| 操作权限   | 管理员               |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述                 | 参数类型 |
| -------- | ----------- | ------------------------ | -------- |
| 用户地址 | userAddress | 要减少钓鱼次数的用户地址 | address  |
| 数量     | count       | 减少的钓鱼次数           | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 7. 恢复钓鱼次数

#### 概要

| 函数中文名 | 恢复钓鱼次数        |
| ---------- | ------------------- |
| 函数英文名 | recoverFishingCount |
| 操作权限   | 管理员              |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述                 | 参数类型 |
| -------- | ----------- | ------------------------ | -------- |
| 用户地址 | userAddress | 要恢复钓鱼次数的用户地址 | address  |
| 数量     | count       | 恢复的钓鱼次数           | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 8. 增加经验

#### 概要

| 函数中文名 | 增加经验      |
| ---------- | ------------- |
| 函数英文名 | addExperience |
| 操作权限   | 管理员        |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
| -------- | ----------- | -------------------- | -------- |
| 用户地址 | userAddress | 要增加经验的用户地址 | address  |
| 经验     | exp         | 增加的经验值         | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 9. 切换渔夫

#### 概要

| 函数中文名 | 切换渔夫        |
| ---------- | --------------- |
| 函数英文名 | changeFisherman |
| 操作权限   | 管理员          |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
| -------- | ----------- | -------------------- | -------- |
| 用户地址 | userAddress | 要切换渔夫的用户地址 | address  |
| 渔夫ID   | fishermanId | 新的渔夫NFT的ID      | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 10. 切换鱼竿

#### 概要

| 函数中文名 | 切换鱼竿  |
| ---------- | --------- |
| 函数英文名 | changeRod |
| 操作权限   | 管理员    |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
| -------- | ----------- | -------------------- | -------- |
| 用户地址 | userAddress | 要切换鱼竿的用户地址 | address  |
| 鳕鱼杆ID | rodId       | 新的鱼竿NFT的ID      | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

### 11. 切换渔夫

#### 概要

| 函数中文名 | 切换渔夫        |
| ---------- | --------------- |
| 函数英文名 | changeFisherman |
| 操作权限   | 管理员          |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
| -------- | ----------- | -------------------- | -------- |
| 用户地址 | userAddress | 要切换渔夫的用户地址 | address  |
| 渔夫ID   | fishermanId | 新的渔夫NFT的ID      | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 12. 切换鱼竿

#### 概要

| 函数中文名 | 切换鱼竿  |
| ---------- | --------- |
| 函数英文名 | changeRod |
| 操作权限   | 管理员    |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
| -------- | ----------- | -------------------- | -------- |
| 鳕鱼杆ID | rodId       | 新的鱼竿NFT的ID      | uint256  |
| 用户地址 | userAddress | 要切换鱼竿的用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 13. 切换钓鱼地点

#### 概要

| 函数中文名 | 切换钓鱼地点      |
| ---------- | ----------------- |
| 函数英文名 | switchFishingSpot |
| 操作权限   | 管理员            |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述                 | 参数类型 |
| -------- | ----------- | ------------------------ | -------- |
| 地点ID   | spotId      | 新的钓鱼地点ID           | uint256  |
| 用户地址 | userAddress | 要切换钓鱼地点的用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 14. 获取解锁的钓鱼地点

#### 概要

| 函数中文名 | 获取解锁的钓鱼地点      |
| ---------- | ----------------------- |
| 函数英文名 | getUnlockedFishingSpots |
| 操作权限   | 无                      |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述         | 参数类型 |
| -------- | ----------- | ---------------- | -------- |
| 用户地址 | userAddress | 要获取的用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述         |
| ---------- | ------------------ |
| bool[5]    | 玩家解锁的钓鱼地点 |

------

### 15. 解锁钓鱼地点

#### 概要

| 函数中文名 | 解锁钓鱼地点      |
| ---------- | ----------------- |
| 函数英文名 | unlockFishingSpot |
| 操作权限   | 管理员            |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述                 | 参数类型 |
| -------- | ----------- | ------------------------ | -------- |
| 用户地址 | userAddress | 要解锁钓鱼地点的用户地址 | address  |
| 地点ID   | spotId      | 要解锁的钓鱼地点ID       | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 16. 获取升级限制

#### 概要

| 函数中文名 | 获取升级限制    |
| ---------- | --------------- |
| 函数英文名 | getLevelUpLimit |
| 操作权限   | 无              |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| uint256    | 升级限制   |

------

### 17. 设置升级限制

#### 概要

| 函数中文名 | 设置升级限制    |
| ---------- | --------------- |
| 函数英文名 | setLevelUpLimit |
| 操作权限   | 管理员          |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述       | 参数类型 |
| -------- | ------------- | -------------- | -------- |
| 升级限制 | _levelUpLimit | 新的升级限制值 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 18. 设置经验配置

#### 概要

| 函数中文名 | 设置经验配置        |
| ---------- | ------------------- |
| 函数英文名 | setExperienceConfig |
| 操作权限   | 管理员              |

#### 输入参数

| 参数名称 | 参数英文名        | 参数描述         | 参数类型  |
| -------- | ----------------- | ---------------- | --------- |
| 经验配置 | _experienceConfig | 新的经验配置数组 | uint256[] |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 19. 获取经验配置

#### 概要

| 函数中文名 | 获取经验配置        |
| ---------- | ------------------- |
| 函数英文名 | getExperienceConfig |
| 操作权限   | 无                  |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述   |
| ---------- | ------------ |
| uint256[]  | 经验配置数组 |

------

### 20. 设置鱼饵购买上限

#### 概要

| 函数中文名 | 设置鱼饵购买上限     |
| ---------- | -------------------- |
| 函数英文名 | setBaitPurchaseLimit |
| 操作权限   | 管理员               |

#### 输入参数

| 参数名称     | 参数英文名         | 参数描述           | 参数类型 |
| ------------ | ------------------ | ------------------ | -------- |
| 鱼饵购买上限 | _baitPurchaseLimit | 新的鱼饵购买上限值 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 21. 设置钓鱼次数上限

#### 概要

| 函数中文名 | 设置钓鱼次数上限     |
| ---------- | -------------------- |
| 函数英文名 | setFishingCountLimit |
| 操作权限   | 管理员               |

#### 输入参数

| 参数名称     | 参数英文名         | 参数描述           | 参数类型 |
| ------------ | ------------------ | ------------------ | -------- |
| 钓鱼次数上限 | _fishingCountLimit | 新的钓鱼次数上限值 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 22. 获取鱼饵购买上限

#### 概要

| 函数中文名 | 获取鱼饵购买上限     |
| ---------- | -------------------- |
| 函数英文名 | getBaitPurchaseLimit |
| 操作权限   | 无                   |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述   |
| ---------- | ------------ |
| uint256    | 鱼饵购买上限 |

------

### 23. 获取钓鱼次数上限

#### 概要

| 函数中文名 | 获取钓鱼次数上限     |
| ---------- | -------------------- |
| 函数英文名 | getFishingCountLimit |
| 操作权限   | 无                   |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述   |
| ---------- | ------------ |
| uint256    | 钓鱼次数上限 |

------

### 24. 获取玩家等级

#### 概要

| 函数中文名 | 获取玩家等级   |
| ---------- | -------------- |
| 函数英文名 | getPlayerLevel |
| 操作权限   | 无             |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述             | 参数类型 |
| -------- | ------------- | -------------------- | -------- |
| 玩家地址 | playerAddress | 要获取等级的玩家地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述   |
| ---------- | ------------ |
| uint256    | 玩家当前等级 |

------

### 25. 设置玩家等级

#### 概要

| 函数中文名 | 设置玩家等级   |
| ---------- | -------------- |
| 函数英文名 | setPlayerLevel |
| 操作权限   | 管理员         |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述             | 参数类型 |
| -------- | ------------- | -------------------- | -------- |
| 玩家地址 | playerAddress | 要设置等级的玩家地址 | address  |
| 新等级   | newLevel      | 玩家的新等级         | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 26. 获取鱼池等级

#### 概要

| 函数中文名 | 获取鱼池等级     |
| ---------- | ---------------- |
| 函数英文名 | getFishPoolLevel |
| 操作权限   | 无               |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述                 | 参数类型 |
| -------- | ------------- | ------------------------ | -------- |
| 玩家地址 | playerAddress | 要获取鱼池等级的玩家地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述   |
| ---------- | ------------ |
| uint256    | 玩家鱼池等级 |

------

### 27. 设置鱼池等级

#### 概要

| 函数中文名 | 设置鱼池等级     |
| ---------- | ---------------- |
| 函数英文名 | setFishPoolLevel |
| 操作权限   | 管理员           |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述                 | 参数类型 |
| -------- | ------------- | ------------------------ | -------- |
| 玩家地址 | playerAddress | 要设置鱼池等级的玩家地址 | address  |
| 新等级   | newLevel      | 玩家的新鱼池等级         | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 28. 获取鱼的数量

#### 概要

| 函数中文名 | 获取鱼的数量 |
| ---------- | ------------ |
| 函数英文名 | getFishCount |
| 操作权限   | 无           |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述               | 参数类型 |
| -------- | ------------- | ---------------------- | -------- |
| 玩家地址 | playerAddress | 要获取鱼数量的玩家地址 | address  |

#### 返回值

| 返回值类型  | 返回值描述         |
| ----------- | ------------------ |
| uint256[10] | 玩家持有的鱼的数量 |

------

### 29. 设置鱼的数量

#### 概要

| 函数中文名 | 设置鱼的数量 |
| ---------- | ------------ |
| 函数英文名 | setFishCount |
| 操作权限   | 管理员       |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述               | 参数类型 |
| -------- | ------------- | ---------------------- | -------- |
| 玩家地址 | playerAddress | 要设置鱼数量的玩家地址 | address  |
| 鱼星级   | star          | 鱼的星级               | uint256  |
| 新数量   | newCount      | 鱼的新数量             | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 30. 获取已收集的GMC

#### 概要

| 函数中文名 | 获取已收集的GMC |
| ---------- | --------------- |
| 函数英文名 | getCollectedGMC |
| 操作权限   | 无              |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述                  | 参数类型 |
| -------- | ------------- | ------------------------- | -------- |
| 玩家地址 | playerAddress | 要获取已收集GMC的玩家地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述      |
| ---------- | --------------- |
| uint256    | 玩家已收集的GMC |

------

### 31. 设置已收集的GMC

#### 概要

| 函数中文名 | 设置已收集的GMC |
| ---------- | --------------- |
| 函数英文名 | setCollectedGMC |
| 操作权限   | 管理员          |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述                  | 参数类型 |
| -------- | ------------- | ------------------------- | -------- |
| 玩家地址 | playerAddress | 要设置已收集GMC的玩家地址 | address  |
| 新金额   | newAmount     | 玩家新的已收集GMC金额     | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 32. 获取鱼饵数量

#### 概要

| 函数中文名 | 获取鱼饵数量 |
| ---------- | ------------ |
| 函数英文名 | getBaitCount |
| 操作权限   | 无           |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述                 | 参数类型 |
| -------- | ------------- | ------------------------ | -------- |
| 玩家地址 | playerAddress | 要获取鱼饵数量的玩家地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述         |
| ---------- | ------------------ |
| uint256    | 玩家持有的鱼饵数量 |

------

### 33. 设置鱼饵数量

#### 概要

| 函数中文名 | 设置鱼饵数量 |
| ---------- | ------------ |
| 函数英文名 | setBaitCount |
| 操作权限   | 管理员       |

#### 输入参数

| 参数名称 | 参数英文名    | 参数描述                 | 参数类型 |
| -------- | ------------- | ------------------------ | -------- |
| 玩家地址 | playerAddress | 要设置鱼饵数量的玩家地址 | address  |
| 新数量   | newCount      | 鱼饵的新数量             | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 34. 获取GMC余额

#### 概要

| 函数中文名 | 获取GMC余额   |
| ---------- | ------------- |
| 函数英文名 | getGMCBalance |
| 操作权限   | 无            |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述                | 参数类型 |
| -------- | ----------- | ----------------------- | -------- |
| 用户地址 | userAddress | 要获取GMC余额的用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述    |
| ---------- | ------------- |
| uint256    | 用户的GMC余额 |

------

### 35. ClaimGMC

#### 概要

| 函数中文名 | 领取GMC  |
| ---------- | -------- |
| 函数英文名 | claimGMC |
| 操作权限   | 管理员   |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述            | 参数类型 |
| -------- | ----------- | ------------------- | -------- |
| 用户地址 | userAddress | 要领取GMC的用户地址 | address  |
| 数量     | count       | 领取的GMC数量       | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 36. 购买鱼饵

#### 概要

| 函数中文名 | 购买鱼饵 |
| ---------- | -------- |
| 函数英文名 | buyBaits |
| 操作权限   | 管理员   |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
| -------- | ----------- | -------------------- | -------- |
| 用户地址 | userAddress | 要购买鱼饵的用户地址 | address  |
| 数量     | count       | 购买的鱼饵数量       | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

### 权限与安全

- **合约所有者 (Owner)**: 合约的所有者具有最高权限，可以转让所有权、管理管理员。
- **管理员 (Admin)**: 管理员具有较大的权限，可以注册玩家、修改玩家状态、处理钓鱼和经验等操作。

------

### 使用场景

1. **玩家注册**: 当新玩家加入游戏时，管理员调用 `addUser` 方法进行玩家注册。
2. **玩家钓鱼**: 玩家钓鱼后，管理员调用 `decreaseFishingCount` 方法减少钓鱼次数，或使用 `recoverFishingCount` 恢复钓鱼次数。
3. **玩家升级**: 玩家获得经验后，管理员调用 `addExperience` 增加经验，并自动处理升级逻辑。
4. **道具管理**: 玩家可以更换渔夫或钓竿 NFT，或通过购买增加鱼饵数量。
5. **GMC 领取**: 玩家可以通过管理员触发 `claimGMC` 领取他们的 GMC 代币。

# 2.渔场合约

## 概述

合约 `FishingSpot` 用于管理游戏中的钓鱼点。管理员可以添加、更新钓鱼点的配置，获取钓鱼点信息。合约基于 `OpenZeppelin` 的 `Ownable` 和 `AccessControl` 合约，确保安全性和权限管理。

------

## 数据结构

#### `SpotConfig`

该结构体存储每个钓鱼点的配置：

- `starLevel`: 钓鱼点的星级。
- `fishList`: 钓鱼点提供的鱼类列表。
- `entryLevel`: 进入该钓鱼点所需的等级。

## 状态变量

- `ADMIN_ROLE`: 管理员权限的标识符，使用 `keccak256` 生成。
- `spotConfigs`: 钓鱼点配置的映射，键为钓鱼点 ID。
- `spotIds`: 所有钓鱼点 ID 的数组。

## 事件

- `FishingSpotAdded(uint256 indexed spotId, uint8 starLevel, uint8 entryLevel)`: 钓鱼点添加事件。
- `FishingSpotUpdated(uint256 indexed spotId, uint8 starLevel, uint8 entryLevel)`: 钓鱼点更新事件。

------

## 函数

### 1. 添加钓鱼点

#### 概要

| 函数中文名 | 添加钓鱼点     |
| ---------- | -------------- |
| 函数英文名 | addFishingSpot |
| 操作权限   | 管理员         |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述               | 参数类型  |
| -------- | ---------- | ---------------------- | --------- |
| 钓鱼点ID | spotId     | 钓鱼点的唯一标识       | uint256   |
| 星级     | starLevel  | 钓鱼点的星级           | uint8     |
| 鱼类列表 | fishList   | 钓鱼点内的鱼类列表     | uint256[] |
| 入场等级 | entryLevel | 进入该钓鱼点所需的等级 | uint8     |

#### 返回值

| 返回值类型 | 返回值描述       |
| ---------- | ---------------- |
| bool       | 操作成功返回true |

------

### 2. 更新钓鱼点

#### 概要

| 函数中文名 | 更新钓鱼点        |
| ---------- | ----------------- |
| 函数英文名 | updateFishingSpot |
| 操作权限   | 管理员            |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述               | 参数类型  |
| -------- | ---------- | ---------------------- | --------- |
| 钓鱼点ID | spotId     | 钓鱼点的唯一标识       | uint256   |
| 星级     | starLevel  | 钓鱼点的星级           | uint8     |
| 鱼类列表 | fishList   | 钓鱼点内的鱼类列表     | uint256[] |
| 入场等级 | entryLevel | 进入该钓鱼点所需的等级 | uint8     |

#### 返回值

| 返回值类型 | 返回值描述       |
| ---------- | ---------------- |
| bool       | 操作成功返回true |

------

### 3. 获取钓鱼点配置

#### 概要

| 函数中文名 | 获取钓鱼点配置       |
| ---------- | -------------------- |
| 函数英文名 | getFishingSpotConfig |
| 操作权限   | 无                   |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| 钓鱼点ID | spotId     | 钓鱼点的唯一标识 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述       |
| ---------- | ---------------- |
| SpotConfig | 钓鱼点的配置信息 |

------

### 4. 获取所有钓鱼点ID

#### 概要

| 函数中文名 | 获取所有钓鱼点ID     |
| ---------- | -------------------- |
| 函数英文名 | getAllFishingSpotIds |
| 操作权限   | 无                   |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述         |
| ---------- | ------------------ |
| uint256[]  | 所有钓鱼点的ID列表 |

------

### 5. 添加管理员

#### 概要

| 函数中文名 | 添加管理员 |
| ---------- | ---------- |
| 函数英文名 | addAdmin   |
| 操作权限   | 所有者     |

#### 输入参数

| 参数名称     | 参数英文名 | 参数描述       | 参数类型 |
| ------------ | ---------- | -------------- | -------- |
| 新管理员地址 | newAdmin   | 新管理员的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 6. 移除管理员

#### 概要

| 函数中文名 | 移除管理员  |
| ---------- | ----------- |
| 函数英文名 | removeAdmin |
| 操作权限   | 所有者      |

#### 输入参数

| 参数名称   | 参数英文名 | 参数描述           | 参数类型 |
| ---------- | ---------- | ------------------ | -------- |
| 管理员地址 | admin      | 要移除的管理员地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

### 7. 放弃管理员身份

#### 概要

| 函数中文名 | 放弃管理员身份 |
| ---------- | -------------- |
| 函数英文名 | renounceAdmin  |
| 操作权限   | 无             |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

------

## 权限与安全

- **合约所有者 (Owner)**: 合约的所有者具有最高权限，可以管理管理员的角色。
- **管理员 (Admin)**: 管理员具有管理钓鱼点的权限，可以添加、更新钓鱼点的配置。

------

## 使用场景

1. **钓鱼点添加**: 当需要增加新的钓鱼点时，管理员调用 `addFishingSpot` 方法。
2. **钓鱼点更新**: 管理员可以通过 `updateFishingSpot` 方法更新现有钓鱼点的配置。
3. **获取钓鱼点信息**: 管理员或任何用户可以调用 `getFishingSpotConfig` 获取特定钓鱼点的详细信息。
4. **查看所有钓鱼点**: 使用 `getAllFishingSpotIds` 方法，可以获取当前所有钓鱼点的 ID 列表。

# 3.钓手NFT合约

## 概述

合约 `FishermanNFT` 是一个基于 ERC721 标准的非同质化代币 (NFT) 合约，允许用户铸造、交易和管理钓手 NFT。该合约集成了权限管理和列出/购买功能，确保安全性和灵活性。

## 数据结构

#### `Listing`

该结构体用于存储 NFT 的上架信息：

- `seller`: 卖家地址。
- `price`: 上架价格。

## 状态变量

- `mintPrice`: 铸造钓手 NFT 的价格。
- `maxSupplies`: 各类钓手 NFT 的最大供应量。
- `mintedSupplies`: 已铸造各类钓手 NFT 的数量。
- `fishermanTypes`: 各 NFT 类型的映射。
- `_tokenURIs`: 存储每个 NFT 的元数据 URI。
- `listings`: NFT 上架信息的映射。

## 事件

- `FishermanMinted(address indexed to, uint256 indexed tokenId)`: 钓手 NFT 被铸造时触发。
- `AdminAdded(address indexed newAdmin)`: 新管理员添加时触发。
- `AdminRemoved(address indexed removedAdmin)`: 管理员被移除时触发。
- `ItemListed(uint256 indexed tokenId, address indexed seller, uint256 price)`: NFT 上架时触发。
- `ItemSold(uint256 indexed tokenId, address indexed buyer, uint256 price)`: NFT 售出时触发。
- `MetadataUpdate(uint256 _tokenId)`: NFT 元数据更新时触发。

### 函数

### 1. 支持接口

#### 概要

| 函数中文名 | 支持接口          |
| ---------- | ----------------- |
| 函数英文名 | supportsInterface |
| 操作权限   | 公共              |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述       | 参数类型 |
| -------- | ----------- | -------------- | -------- |
| 接口ID   | interfaceId | 要检查的接口ID | bytes4   |

#### 返回值

| 返回值类型 | 返回值描述                         |
| ---------- | ---------------------------------- |
| bool       | 如果合约支持指定接口，则返回true。 |

#### 逻辑

该函数检查合约是否支持指定的接口ID。返回值为true或false，具体取决于接口是否被支持。

------

### 2. 铸造钓手NFT

#### 概要

| 函数中文名 | 铸造钓手NFT   |
| ---------- | ------------- |
| 函数英文名 | mintFisherman |
| 操作权限   | 外部          |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述                  |
| ---------- | --------------------------- |
| uint256    | 新铸造的钓手NFT的token ID。 |

#### 逻辑

该函数允许用户支付一定金额以铸造钓手NFT。根据生成的随机数决定钓手的类型，并检查该类型的最大供应限制。如果用户支付金额超过铸造价格，多余的金额会被退还。

------

### 3. 免费铸造钓手NFT

#### 概要

| 函数中文名 | 免费铸造钓手NFT   |
| ---------- | ----------------- |
| 函数英文名 | freeMintFisherman |
| 操作权限   | 仅管理员          |

#### 输入参数

| 参数名称 | 参数英文名  | 参数描述            | 参数类型 |
| -------- | ----------- | ------------------- | -------- |
| 玩家地址 | playAddress | 钓手NFT接收者的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述                  |
| ---------- | --------------------------- |
| uint256    | 新铸造的钓手NFT的token ID。 |

#### 逻辑

此函数由管理员调用以免费铸造钓手NFT。逻辑与`mintFisherman`相似，决定钓手类型并进行铸造。

------

### 4. 转移NFT

#### 概要

| 函数中文名 | 转移NFT      |
| ---------- | ------------ |
| 函数英文名 | transferFrom |
| 操作权限   | 仅管理员     |

#### 输入参数

| 参数名称   | 参数英文名 | 参数描述            | 参数类型 |
| ---------- | ---------- | ------------------- | -------- |
| 发件人地址 | from       | 当前NFT持有者的地址 | address  |
| 收件人地址 | to         | 新的NFT持有者的地址 | address  |
| token ID   | tokenId    | 要转移的NFT的ID     | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

管理员可以使用此函数转移NFT，实际调用`_transfer`方法完成转移。

------

### 5. 设置基础Token URI

#### 概要

| 函数中文名 | 设置基础Token URI |
| ---------- | ----------------- |
| 函数英文名 | setBaseTokenURI   |
| 操作权限   | 仅管理员          |

#### 输入参数

| 参数名称  | 参数英文名      | 参数描述          | 参数类型 |
| --------- | --------------- | ----------------- | -------- |
| 新基础URI | newBaseTokenURI | 新的基础Token URI | string   |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

该函数允许管理员设置合约的基础Token URI。

------

### 6. 铸造价格设置

#### 概要

| 函数中文名 | 设置铸造价格 |
| ---------- | ------------ |
| 函数英文名 | setMintPrice |
| 操作权限   | 仅管理员     |

#### 输入参数

| 参数名称   | 参数英文名   | 参数描述     | 参数类型 |
| ---------- | ------------ | ------------ | -------- |
| 新铸造价格 | newMintPrice | 新的铸造价格 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

允许管理员更新NFT的铸造价格。

### 7. 提取合约余额

#### 概要

| 函数中文名 | 提取合约余额 |
| ---------- | ------------ |
| 函数英文名 | withdraw     |
| 操作权限   | 仅所有者     |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

此函数允许合约的所有者提取合约中的所有余额，转账到所有者的地址。

------

### 8. 返回合约名称

#### 概要

| 函数中文名 | 返回合约名称 |
| ---------- | ------------ |
| 函数英文名 | name         |
| 操作权限   | 公共         |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| string     | 合约的名称 |

#### 逻辑

此函数返回合约的名称。

------

### 9. 返回合约符号

#### 概要

| 函数中文名 | 返回合约符号 |
| ---------- | ------------ |
| 函数英文名 | symbol       |
| 操作权限   | 公共         |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| string     | 合约的符号 |

#### 逻辑

此函数返回合约的符号。

------

### 10. 查询Token URI

#### 概要

| 函数中文名 | 查询Token URI |
| ---------- | ------------- |
| 函数英文名 | tokenURI      |
| 操作权限   | 公共          |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述              | 参数类型 |
| -------- | ---------- | --------------------- | -------- |
| token ID | tokenId    | 要查询的NFT的token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述              |
| ---------- | ----------------------- |
| string     | 返回指定token ID的URI。 |

#### 逻辑

此函数返回指定token ID的URI。如果没有设置基础URI，则返回token的自定义URI；如果有基础URI，则返回拼接后的完整URI。

------

### 11. 设置Token URI

#### 概要

| 函数中文名 | 设置Token URI |
| ---------- | ------------- |
| 函数英文名 | setTokenURI   |
| 操作权限   | 内部          |

#### 输入参数

| 参数名称  | 参数英文名 | 参数描述                 | 参数类型 |
| --------- | ---------- | ------------------------ | -------- |
| token ID  | tokenId    | 要设置URI的NFT的token ID | uint256  |
| token CID | tokenCID   | 要设置的token的CID       | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

该函数为指定token ID设置metadata URI，URI格式为基础URI与token CID的拼接。确保token存在。

------

### 12. 代币转移前逻辑

#### 概要

| 函数中文名 | 代币转移前逻辑       |
| ---------- | -------------------- |
| 函数英文名 | _beforeTokenTransfer |
| 操作权限   | 内部                 |

#### 输入参数

| 参数名称       | 参数英文名   | 参数描述            | 参数类型 |
| -------------- | ------------ | ------------------- | -------- |
| 发件人地址     | from         | 当前NFT持有者的地址 | address  |
| 收件人地址     | to           | 新的NFT持有者的地址 | address  |
| 第一个token ID | firstTokenId | 第一个token ID      | uint256  |
| 批量大小       | batchSize    | 转移的token数量     | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

在每次token转移前，检查转移的合法性，并更新相关的拥有者和全局token枚举信息。

------

### 13. 总供应量

#### 概要

| 函数中文名 | 总供应量    |
| ---------- | ----------- |
| 函数英文名 | totalSupply |
| 操作权限   | 公共        |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述            |
| ---------- | --------------------- |
| uint256    | 当前铸造的token总数。 |

#### 逻辑

返回当前铸造的NFT总数。

------

### 14. 根据索引查询Token

#### 概要

| 函数中文名 | 根据索引查询Token |
| ---------- | ----------------- |
| 函数英文名 | tokenByIndex      |
| 操作权限   | 公共              |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 索引     | index      | 全局索引 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述               |
| ---------- | ------------------------ |
| uint256    | 返回指定索引的token ID。 |

#### 逻辑

根据全局索引返回token ID，确保索引在合法范围内。

------

### 15. 上架NFT

#### 概要

| 函数中文名 | 上架NFT  |
| ---------- | -------- |
| 函数英文名 | listItem |
| 操作权限   | 外部     |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述              | 参数类型 |
| -------- | ---------- | --------------------- | -------- |
| token ID | tokenId    | 要上架的NFT的token ID | uint256  |
| 价格     | price      | 上架NFT的价格         | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

将NFT上架进行出售，确保价格大于0并且调用者是NFT的所有者。

------

### 16. 购买NFT

#### 概要

| 函数中文名 | 购买NFT |
| ---------- | ------- |
| 函数英文名 | buyItem |
| 操作权限   | 外部    |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述              | 参数类型 |
| -------- | ---------- | --------------------- | -------- |
| token ID | tokenId    | 要购买的NFT的token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

根据上架信息进行购买，确保支付金额与价格匹配，并将NFT转移给买家。

------

### 17. 取消上架

#### 概要

| 函数中文名 | 取消上架      |
| ---------- | ------------- |
| 函数英文名 | cancelListing |
| 操作权限   | 外部          |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述                  | 参数类型 |
| -------- | ---------- | ------------------------- | -------- |
| token ID | tokenId    | 要取消上架的NFT的token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

取消NFT的上架，并将NFT返回给卖家。

------

### 18. 随机数生成

#### 概要

| 函数中文名 | 随机数生成 |
| ---------- | ---------- |
| 函数英文名 | random     |
| 操作权限   | 内部       |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述     |
| ---------- | -------------- |
| uint256    | 生成的伪随机数 |

#### 逻辑

生成一个伪随机数，基于区块时间戳、前一个区块的随机值和调用者地址的哈希值。

### 19. 查询某地址下的所有NFT

#### 概要

| 函数中文名 | 取消上架     |
| ---------- | ------------ |
| 函数英文名 | getOwnedNFTs |
| 操作权限   | 公共         |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| 地址     | address    | 要查询玩家的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述  |
| ---------- | ----------- |
| uint256[]  | 所有NFT列表 |

## 权限与安全

- **合约所有者 (Owner)**: 合约的所有者具有最高权限，可以管理合约和资金。
- **管理员 (Admin)**: 具备管理铸造和设置基础 URI 等权限。

## 使用场景

1. **铸造钓手 NFT**: 用户通过 `mintFisherman` 或 `freeMintFisherman` 函数铸造钓手 NFT。
2. **市场交易**: 用户可以通过 `listItem` 上架 NFT，使用 `buyItem` 购买 NFT。
3. **管理功能**: 管理员可以设置铸造价格和基础 URI，管理 NFT 的流通和信息。

## 注意事项

- 确保遵循合约的权限管理和安全性要求，以防止不当操作。
- 进行市场交易时，请仔细检查 NFT 的上架信息和价格。

# 4.鱼竿NFT合约

## 概述

合约 `FishingRodNFT` 是一个基于 ERC721 标准的非同质化代币 (NFT) 合约，允许用户铸造、交易和管理鱼竿 NFT。合约集成了权限管理、市场功能和元数据管理，确保了安全性和灵活性。

## 数据结构

#### `Listing`

用于存储 NFT 上架信息：

- `seller`: 卖家地址。
- `price`: 上架价格。

#### `RodAttributes`

用于存储鱼竿的属性：

- `image`: 鱼竿图像。
- `qteCount`: 数量。
- `innerValue`: 内部值。
- `outerValue`: 外部值。
- `comboValue`: 组合值。
- `name`: 鱼竿名称。
- `skillName`: 技能名称。
- `skillValue`: 技能值。
- `qteSkill`: 数量技能。
- `rodId`: 鱼竿 ID。

## 状态变量

- `_name`: 代币名称。
- `_symbol`: 代币符号。
- `_tokenIds`: 当前铸造的 NFT ID 计数器。
- `_ownedTokens`: 存储用户拥有的 NFT ID。
- `_ownedTokensIndex`: 存储每个 NFT 在用户拥有的 NFT 列表中的索引。
- `_allTokens`: 所有 NFT ID 数组。
- `_allTokensIndex`: 存储每个 NFT 在 `_allTokens` 数组中的位置。
- `ADMIN_ROLE`: 管理员角色。
- `_baseTokenURI`: 基础 URI。
- `mintPrice`: 鱼竿 NFT 铸造价格。
- `mintedSupplies`: 各类型鱼竿已铸造数量。
- `rodTypes`: 映射 NFT ID 到鱼竿类型。

## 事件

- `RodMinted(address indexed to, uint256 indexed tokenId)`: 鱼竿 NFT 被铸造时触发。
- `RodAttributesUpdated(uint256 indexed tokenId)`: 鱼竿属性更新时触发。
- `AdminAdded(address indexed newAdmin)`: 新管理员添加时触发。
- `AdminRemoved(address indexed removedAdmin)`: 管理员被移除时触发。
- `ItemListed(uint256 indexed tokenId, address indexed seller, uint256 price)`: NFT 上架时触发。
- `ItemSold(uint256 indexed tokenId, address indexed buyer, uint256 price)`: NFT 售出时触发。

## 函数

- ### 1. 支持接口函数

  #### 概要
  
  | 函数中文名 | 支持接口          |
  | ---------- | ----------------- |
  | 函数英文名 | supportsInterface |
  | 操作权限   | 公共              |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名  | 参数描述             | 参数类型 |
  | -------- | ----------- | -------------------- | -------- |
  | 接口ID   | interfaceId | 需要检查支持的接口ID | bytes4   |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述       |
  | ---------- | ---------------- |
  | bool       | 是否支持指定接口 |
  
  ------
  
  ### 2. 铸造鱼竿函数
  
  #### 概要
  
  | 函数中文名 | 铸造鱼竿 |
  | ---------- | -------- |
  | 函数英文名 | mintRod  |
  | 操作权限   | 外部     |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
  | -------- | ---------- | -------- | -------- |
  | 无       | 无         | 无       | 无       |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述           |
  | ---------- | -------------------- |
  | uint256    | 新铸造鱼竿的Token ID |
  
  #### 逻辑
  
  该函数允许用户支付一定费用铸造一根鱼竿。首先检查支付金额是否足够。然后计算所有鱼竿类型的总供应量，并根据随机数决定铸造的鱼竿类型。确保所选类型的铸造数量未达到上限，生成新的Token ID并铸造该鱼竿。铸造后，如果支付金额超出设定的铸造价格，则退还多余的金额。
  
  ------
  
  ### 3. 免费铸造鱼竿函数
  
  #### 概要
  
  | 函数中文名 | 免费铸造鱼竿 |
  | ---------- | ------------ |
  | 函数英文名 | freeMintRod  |
  | 操作权限   | 仅管理员     |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名  | 参数描述               | 参数类型 |
  | -------- | ----------- | ---------------------- | -------- |
  | 玩家地址 | playAddress | 接收铸造鱼竿的玩家地址 | address  |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述           |
  | ---------- | -------------------- |
  | uint256    | 新铸造鱼竿的Token ID |
  
  #### 逻辑
  
  该函数允许管理员为指定的玩家免费铸造鱼竿。与铸造鱼竿函数类似，先计算总供应量并随机选择鱼竿类型，确保所选类型的铸造数量未达到上限。生成新的Token ID并铸造该鱼竿。
  
  ------
  
  ### 4. 转移函数
  
  #### 概要
  
  | 函数中文名 | 转移         |
  | ---------- | ------------ |
  | 函数英文名 | transferFrom |
  | 操作权限   | 仅管理员     |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述            | 参数类型 |
  | -------- | ---------- | ------------------- | -------- |
  | 发送者   | from       | 转移的NFT所有者地址 | address  |
  | 接收者   | to         | 新的NFT所有者地址   | address  |
  | Token ID | tokenId    | 要转移的Token ID    | uint256  |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | 无         | 无         |
  
  ------
  
  ### 5. 转移所有权函数
  
  #### 概要
  
  | 函数中文名 | 转移所有权        |
  | ---------- | ----------------- |
  | 函数英文名 | transferOwnership |
  | 操作权限   | 仅拥有者          |
  
  #### 输入参数
  
  | 参数名称     | 参数英文名 | 参数描述       | 参数类型 |
  | ------------ | ---------- | -------------- | -------- |
  | 新拥有者地址 | newOwner   | 新的拥有者地址 | address  |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | 无         | 无         |
  
  #### 逻辑
  
  该函数允许当前合约的拥有者将合约的控制权转移给新的拥有者。确保新地址不为空。
  
  ------
  
  ### 6. 设置基础Token URI函数
  
  #### 概要
  
  | 函数中文名 | 设置基础Token URI |
  | ---------- | ----------------- |
  | 函数英文名 | setBaseTokenURI   |
  | 操作权限   | 仅管理员          |
  
  #### 输入参数
  
  | 参数名称        | 参数英文名      | 参数描述          | 参数类型 |
  | --------------- | --------------- | ----------------- | -------- |
  | 新基础Token URI | newBaseTokenURI | 新的基础Token URI | string   |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | 无         | 无         |
  
  ------
  
  ### 7. 设置铸造价格函数
  
  #### 概要
  
  | 函数中文名 | 设置铸造价格 |
  | ---------- | ------------ |
  | 函数英文名 | setMintPrice |
  | 操作权限   | 仅管理员     |
  
  #### 输入参数
  
  | 参数名称   | 参数英文名   | 参数描述     | 参数类型 |
  | ---------- | ------------ | ------------ | -------- |
  | 新铸造价格 | newMintPrice | 新的铸造价格 | uint256  |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | 无         | 无         |
  
  ------
  
  ### 8. 基础URI函数
  
  #### 概要
  
  | 函数中文名 | 基础URI  |
  | ---------- | -------- |
  | 函数英文名 | _baseURI |
  | 操作权限   | 内部     |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
  | -------- | ---------- | -------- | -------- |
  | 无       | 无         | 无       | 无       |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述        |
  | ---------- | ----------------- |
  | string     | 当前基础Token URI |
  
  ------
  
  ### 9. Token URI函数
  
  #### 概要
  
  | 函数中文名 | Token URI |
  | ---------- | --------- |
  | 函数英文名 | tokenURI  |
  | 操作权限   | 公共      |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述       | 参数类型 |
  | -------- | ---------- | -------------- | -------- |
  | Token ID | tokenId    | 查询的Token ID | uint256  |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述     |
  | ---------- | -------------- |
  | string     | 指定Token的URI |
  
  #### 逻辑
  
  该函数返回指定Token的URI。确保Token存在，然后根据Token的类型和基础URI生成完整URI。
  
  ------
  
  ### 10. 提现函数
  
  #### 概要
  
  | 函数中文名 | 提现     |
  | ---------- | -------- |
  | 函数英文名 | withdraw |
  | 操作权限   | 仅拥有者 |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
  | -------- | ---------- | -------- | -------- |
  | 无       | 无         | 无       | 无       |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | 无         | 无         |
  
  ------
  
  ### 11. 获取合约名称函数
  
  #### 概要
  
  | 函数中文名 | 获取合约名称 |
  | ---------- | ------------ |
  | 函数英文名 | name         |
  | 操作权限   | 公共         |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
  | -------- | ---------- | -------- | -------- |
  | 无       | 无         | 无       | 无       |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | string     | 合约的名称 |
  
  ------
  
  ### 12. 获取合约符号函数
  
  #### 概要
  
  | 函数中文名 | 获取合约符号 |
  | ---------- | ------------ |
  | 函数英文名 | symbol       |
  | 操作权限   | 公共         |
  
  #### 输入参数
  
  | 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
  | -------- | ---------- | -------- | -------- |
  | 无       | 无         | 无       | 无       |
  
  #### 返回值
  
  | 返回值类型 | 返回值描述 |
  | ---------- | ---------- |
  | string     | 合约的符号 |

### 13. 代币转移前处理函数

#### 概要

| 函数中文名 | 代币转移前处理       |
| ---------- | -------------------- |
| 函数英文名 | _beforeTokenTransfer |
| 操作权限   | 内部                 |

#### 输入参数

| 参数名称       | 参数英文名   | 参数描述            | 参数类型 |
| -------------- | ------------ | ------------------- | -------- |
| 发送者         | from         | 转移的NFT所有者地址 | address  |
| 接收者         | to           | 新的NFT所有者地址   | address  |
| 第一个Token ID | firstTokenId | 第一个Token ID      | uint256  |
| 批次大小       | batchSize    | 转移的Token数量     | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

在Token转移前执行的一些操作，如更新拥有者的Token列表、处理批量转移时的特殊情况、确保不支持批量转移等。

------

### 14. 添加Token到所有者枚举的私有函数

#### 概要

| 函数中文名 | 添加Token到所有者枚举       |
| ---------- | --------------------------- |
| 函数英文名 | _addTokenToOwnerEnumeration |
| 操作权限   | 私有                        |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述            | 参数类型 |
| -------- | ---------- | ------------------- | -------- |
| 新拥有者 | to         | 新的Token拥有者地址 | address  |
| Token ID | tokenId    | 要添加的Token ID    | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

将指定Token添加到新拥有者的Token列表中，更新Token的索引以便于后续查找。

------

### 15. 添加Token到所有Token枚举的私有函数

#### 概要

| 函数中文名 | 添加Token到所有Token枚举        |
| ---------- | ------------------------------- |
| 函数英文名 | _addTokenToAllTokensEnumeration |
| 操作权限   | 私有                            |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| Token ID | tokenId    | 要添加的Token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

将指定Token添加到所有Token的列表中，更新其索引以便于后续访问。

------

### 16. 从所有者枚举中移除Token的私有函数

#### 概要

| 函数中文名 | 从所有者枚举中移除Token          |
| ---------- | -------------------------------- |
| 函数英文名 | _removeTokenFromOwnerEnumeration |
| 操作权限   | 私有                             |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述            | 参数类型 |
| -------- | ---------- | ------------------- | -------- |
| 发送者   | from       | 转移的NFT所有者地址 | address  |
| Token ID | tokenId    | 要移除的Token ID    | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

从指定Token所有者的Token列表中移除Token，优化Token转移过程中的数据结构。

------

### 17. 从所有Token枚举中移除Token的私有函数

#### 概要

| 函数中文名 | 从所有Token枚举中移除Token           |
| ---------- | ------------------------------------ |
| 函数英文名 | _removeTokenFromAllTokensEnumeration |
| 操作权限   | 私有                                 |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| Token ID | tokenId    | 要移除的Token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

从所有Token的列表中移除指定Token，确保数据结构的准确性。

------

### 18. 根据索引获取所有者的Token ID

#### 概要

| 函数中文名 | 根据索引获取所有者的Token ID |
| ---------- | ---------------------------- |
| 函数英文名 | tokenOfOwnerByIndex          |
| 操作权限   | 公共                         |

#### 输入参数

| 参数名称   | 参数英文名 | 参数描述              | 参数类型 |
| ---------- | ---------- | --------------------- | -------- |
| 拥有者地址 | owner      | 查询Token的所有者地址 | address  |
| 索引       | index      | 要查询的Token索引     | uint256  |

#### 返回值

| 返回值类型 | 返回值描述         |
| ---------- | ------------------ |
| uint256    | 指定索引的Token ID |

#### 逻辑

根据提供的索引返回指定所有者的Token ID，确保索引在有效范围内。

------

### 19. 总供应量函数

#### 概要

| 函数中文名 | 总供应量    |
| ---------- | ----------- |
| 函数英文名 | totalSupply |
| 操作权限   | 公共        |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述            |
| ---------- | --------------------- |
| uint256    | 当前合约的Token总数量 |

------

### 20. 根据索引获取Token ID

#### 概要

| 函数中文名 | 根据索引获取Token ID |
| ---------- | -------------------- |
| 函数英文名 | tokenByIndex         |
| 操作权限   | 公共                 |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述        | 参数类型 |
| -------- | ---------- | --------------- | -------- |
| 索引     | index      | 查询的Token索引 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述         |
| ---------- | ------------------ |
| uint256    | 指定索引的Token ID |

#### 逻辑

根据提供的索引返回Token ID，确保索引在有效范围内。

------

### 21. 上架鱼竿函数

#### 概要

| 函数中文名 | 上架物品 |
| ---------- | -------- |
| 函数英文名 | listItem |
| 操作权限   | 公共     |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| Token ID | tokenId    | 要上架的Token ID | uint256  |
| 价格     | price      | 上架价格         | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

将指定Token上架进行出售。检查价格是否大于零，确保调用者是Token的所有者，并将Token转移到合约以进行托管。

------

### 22. 购买鱼竿函数

#### 概要

| 函数中文名 | 购买物品 |
| ---------- | -------- |
| 函数英文名 | buyItem  |
| 操作权限   | 公共     |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| Token ID | tokenId    | 要购买的Token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

允许用户购买上架的NFT，检查NFT是否已上架并确保支付金额正确。将NFT从合约转移到买家，并将支付金额转给卖家。

------

### 23. 取消上架函数

#### 概要

| 函数中文名 | 取消上架      |
| ---------- | ------------- |
| 函数英文名 | cancelListing |
| 操作权限   | 公共          |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述             | 参数类型 |
| -------- | ---------- | -------------------- | -------- |
| Token ID | tokenId    | 要取消上架的Token ID | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

允许卖家取消Token的上架，确保调用者是卖家，并将Token返还给卖家。

### 24. 查询某地址下的所有NFT

#### 概要

| 函数中文名 | 取消上架     |
| ---------- | ------------ |
| 函数英文名 | getOwnedNFTs |
| 操作权限   | 公共         |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述         | 参数类型 |
| -------- | ---------- | ---------------- | -------- |
| 地址     | address    | 要查询玩家的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述  |
| ---------- | ----------- |
| uint256[]  | 所有NFT列表 |

## 权限与安全

- **合约所有者 (Owner)**: 具有最高权限，可以管理合约和资金。
- **管理员 (Admin)**: 具备管理铸造、设置基础 URI 等权限。

## 使用场景

1. **铸造鱼竿 NFT**: 用户通过 `mintRod` 或 `freeMintRod` 函数铸造鱼竿 NFT。
2. **市场交易**: 用户可以通过 `listItem` 上架 NFT，使用 `buyItem` 购买 NFT。
3. **管理功能**: 管理员可以设置铸造价格和基础 URI，管理 NFT 的流通和信息。

## 注意事项

- 确保遵循合约的权限管理和安全性要求，以防止不当操作。
- 在进行市场交易时，请仔细检查 NFT 的上架信息和价格。

# 5.GMC合约

## 概述

合约 `GMC` 是一个基于 ERC20 标准的代币合约，具备管理功能，允许合约所有者和指定管理员进行代币的铸造和转移。该合约集成了权限管理，以确保只有授权的账户能够执行特定操作。

## 状态变量

- `_admins`: 存储管理员地址的映射。
- `initialSupply`: 初始供应量。

## 事件

- `AdminAdded(address indexed account)`: 新管理员添加时触发。
- `AdminRemoved(address indexed account)`: 管理员移除时触发。

## 函数

### 1. 获取小数位数

#### 概要

| 函数中文名 | 获取小数位数 |
| ---------- | ------------ |
| 函数英文名 | decimals     |
| 操作权限   | 公共         |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 无       | 无         | 无       | 无       |

#### 返回值

| 返回值类型 | 返回值描述     |
| ---------- | -------------- |
| uint8      | 代币的小数位数 |

#### 逻辑

返回代币的小数位数，默认为18。

------

### 2. 添加管理员

#### 概要

| 函数中文名 | 添加管理员   |
| ---------- | ------------ |
| 函数英文名 | addAdmin     |
| 操作权限   | 仅合约所有者 |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述             | 参数类型 |
| -------- | ---------- | -------------------- | -------- |
| 账户地址 | account    | 要添加为管理员的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

将指定地址添加为管理员，确保该地址尚未是管理员，并触发添加管理员事件。

------

### 3. 移除管理员

#### 概要

| 函数中文名 | 移除管理员   |
| ---------- | ------------ |
| 函数英文名 | removeAdmin  |
| 操作权限   | 仅合约所有者 |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述             | 参数类型 |
| -------- | ---------- | -------------------- | -------- |
| 账户地址 | account    | 要移除的管理员的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

将指定地址移除管理员角色，确保该地址确实是管理员，并触发移除管理员事件。

------

### 4. 查询管理员状态

#### 概要

| 函数中文名 | 查询管理员状态 |
| ---------- | -------------- |
| 函数英文名 | isAdmin        |
| 操作权限   | 公共           |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述     | 参数类型 |
| -------- | ---------- | ------------ | -------- |
| 账户地址 | account    | 要查询的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述         |
| ---------- | ------------------ |
| bool       | 该地址是否为管理员 |

#### 逻辑

返回指定地址是否为管理员。

------

### 5. 铸造代币

#### 概要

| 函数中文名 | 铸造代币 |
| ---------- | -------- |
| 函数英文名 | mint     |
| 操作权限   | 仅管理员 |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述           | 参数类型 |
| -------- | ---------- | ------------------ | -------- |
| 接收地址 | to         | 接收铸造代币的地址 | address  |
| 数量     | amount     | 要铸造的代币数量   | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

允许管理员铸造指定数量的代币给指定地址。

------

### 6. 转移代币

#### 概要

| 函数中文名 | 转移代币 |
| ---------- | -------- |
| 函数英文名 | transfer |
| 操作权限   | 仅管理员 |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述       | 参数类型 |
| -------- | ---------- | -------------- | -------- |
| 发件地址 | from       | 发送代币的地址 | address  |
| 收件地址 | to         | 接收代币的地址 | address  |
| 数量     | amount     | 转移的代币数量 | uint256  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

允许管理员从一个地址向另一个地址转移代币。

------

### 7. 转移合约所有权

#### 概要

| 函数中文名 | 转移合约所有权    |
| ---------- | ----------------- |
| 函数英文名 | transferOwnership |
| 操作权限   | 仅合约所有者      |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述           | 参数类型 |
| -------- | ---------- | ------------------ | -------- |
| 新所有者 | newOwner   | 新合约所有者的地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| 无         | 无         |

#### 逻辑

转移合约的所有权给新的地址，确保新地址不是零地址。

### 8. 查询用户GMC余额

#### 概要

| 函数中文名 | 查询用户GMC余额 |
| ---------- | --------------- |
| 函数英文名 | balanceOf       |
| 操作权限   | 所有人          |

#### 输入参数

| 参数名称 | 参数英文名 | 参数描述 | 参数类型 |
| -------- | ---------- | -------- | -------- |
| 用户地址 | account    | 用户地址 | address  |

#### 返回值

| 返回值类型 | 返回值描述 |
| ---------- | ---------- |
| uint256    | GMC个数    |

## 权限与安全

- **合约所有者 (Owner)**: 具有最高权限，可以管理合约、添加或移除管理员、铸造代币和转移合约所有权。
- **管理员 (Admin)**: 具备铸造代币和转移代币的权限，但不能管理合约所有权。

## 使用场景

1. **铸造代币**: 管理员可以通过 `mint` 函数为指定地址铸造新代币。
2. **代币转移**: 管理员可以通过 `transfer` 函数执行代币的转移操作。
3. **管理员管理**: 合约所有者可以添加或移除管理员，以控制谁有权执行特定操作。

## 注意事项

- 在添加或移除管理员时，请确保操作的安全性，避免不必要的权限提升。
- 管理员的铸造和转移功能需要谨慎使用，以防止滥用。